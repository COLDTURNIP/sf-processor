- list: operations
  items: ["clone", "execve", "exit"]

- macro: is_python
  condition: container.name contains node and proc.exe contains python

- macro: is_node
  condition: container.name contains node and proc.exe contains node

- rule: Simple rule to test if Python process
  desc: unit test macro rule
  condition: container.name contains node and sf.state=CREATE and sf.type=ProcessFlow and 
  (evt.type=clone or evt.type=execve or evt.type=exit) and 
  evt.type in (clone, execve, exit) and is_node and not is_python and proc.name exists
  action: [alert]
  priority: NOTICE
  tags: [test]

- rule: client
  desc: client rule
  condition: sf.type=PE and sf.proc.name contains client
  action: [alert]
  priority: NOTICE
  tags: [client]

- rule: server
  desc: server rule
  condition: sf.type=PE and sf.proc.aname contains server
  action: [alert]
  priority: NOTICE
  tags: [server]

- rule: exfil
  desc: exfil rule
  condition: sf.proc.aname contains exfil.py
  action: [alert]
  priority: HIGH
  tags: [exfil]
